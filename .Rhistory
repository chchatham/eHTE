install.packages("devtools")
library(devtools)
install_github("chchatham/eHTE")
install_github("/chchatham/eHTE")
install_github("chchatham/eHTE/")
install_github("chchatham/eHTE")
devtools::install_github("chchatham/eHTE")
devtools::install_github("chchatham/eHTE")
?eHTE
library(eHTE)
?eHTE
a <- c(.8,.8,.8)
(1-a)
sum(log(1-a))
exp(sum(log(1-a)))
install.packages("devtools")
install.packages("devtools")
library(devtools)
devtools::install_github("chchatham/eHTE")
?eHTE
library(eHTE)
# Check help for eHTE package
?eHTE
library(devtools)
library(roxygen2)
setwd("/Users/chrischatham/eHTE")
setwd("/Users/chrischatham/eHTE")
install_github("chchatham/eHTE",force=TRUE)
setwd("~/Google Drive/My Drive/new adventure/I.Ai Shared Drive/08. Press and Public Presentations/ACNP Submission")
setwd("~/Google Drive/My Drive/new adventure/I.Ai Shared Drive/08. Press and Public Presentations/ACNP Submission")
library(eHTE)
?eHTE
head(loebel_data)
?estimateHTE
df <- read.csv("Usona_PSIL2012.csv")
df <- read.csv("Usona_PSIL2012.csv")
head(df)
library(tidyverse)
head(df)
unique(df$PARAM)
unique(df$AVISIT)
df_chg <- df %>% pivot_wider(names_from = AVISIT,
values_from = AVALC)
head(df_chg)
df_chg <- df %>% pivot_wider(names_from = AVISIT,
values_from = AVALC) %>%
mutate(chg = `Week 6` - Baseline)
head(df_chg)
uniqu(df_chg$ARM)
unique(df_chg$ARM)
result <- estimateHTE(df_chg[loebel_data$arm=="Placebo","chg"],df_chg[df_chg$arm=="Psilocybin","chg"])
result <- estimateHTE(df_chg[df_chg$arm=="Placebo","chg"],df_chg[df_chg$arm=="Psilocybin","chg"])
df_chg <- df %>% pivot_wider(names_from = AVISIT, values_from = AVALC) %>% mutate(chg = `Week 6` - Baseline)
result <- estimateHTE(df_chg[df_chg$ARM=="Placebo","chg"],df_chg[df_chg$ARM=="Psilocybin","chg"])
class)df_chg
class(df_chg)
df_chg <- df %>% pivot_wider(names_from = AVISIT, values_from = AVALC) %>% mutate(chg = `Week 6` - Baseline) %>% as.data.frame(.)
class(df_chg)
result <- estimateHTE(df_chg[df_chg$ARM=="Placebo","chg"],df_chg[df_chg$ARM=="Psilocybin","chg"])
plot(result)
summary(result)
testHTE(result)
a<- testHTE(result)
a <- testHTE(result)
a
summary(a)
.035*2
setwd("~/Google Drive/My Drive/new adventure/I.Ai Shared Drive/08. Press and Public Presentations/ACNP Submission")
library(eHTE)
library(tidyverse)
df <- read.csv("Usona_PSIL2012.csv")
df_chg <- df %>% pivot_wider(names_from = AVISIT, values_from = AVALC) %>% mutate(chg = `Week 6` - Baseline) %>% as.data.frame(.)
result <- estimateHTE(df_chg[df_chg$ARM=="Placebo","chg"],df_chg[df_chg$ARM=="Psilocybin","chg"])
plot(result)
summary(result)
a <- testHTE(result)
a
print(a)
summary(a)
R.version
setwd("~/Google Drive/My Drive/new adventure/I.Ai Shared Drive/08. Press and Public Presentations/ACNP Submission")
library(eHTE)
library(tidyverse)
df <- read.csv("Usona_PSIL2012.csv")
df_chg <- df %>% pivot_wider(names_from = AVISIT, values_from = AVALC) %>% mutate(chg = `Week 6` - Baseline) %>% as.data.frame(.)
nrow(df_chg)
result <- estimateHTE(df_chg[df_chg$ARM=="Placebo","chg"],df_chg[df_chg$ARM=="Psilocybin","chg"])
plot(result)
summary(result)
a <- testHTE(result)
summary(a)
a
class(A)
class(a)
a
print(a)
summary(a)
a
install_github("chchatham/eHTE",force=TRUE)
library(devtools)
library(roxygen2)
install_github("chchatham/eHTE",force=TRUE)
library(eHTE)
library(tidyverse)
df <- read.csv("Usona_PSIL2012.csv")
df_chg <- df %>% pivot_wider(names_from = AVISIT, values_from = AVALC) %>% mutate(chg = `Week 6` - Baseline) %>% as.data.frame(.)
result <- estimateHTE(df_chg[df_chg$ARM=="Placebo","chg"],df_chg[df_chg$ARM=="Psilocybin","chg"])
plot(result)
summary(result)
a <- testHTE(result)
summary(a)
a
print.default(a)
print(a)
print(a)
install_github("chchatham/eHTE",force=TRUE)
library(eHTE)
devtools::install_github("chchatham/eHTE")
devtools::install_github("chchatham/eHTE",force=TRUE)
setwd("/Users/chrischatham/eHTE")
document()
build()
devtools::install_github("chchatham/eHTE",force=TRUE)
library(eHTE)
library(tidyverse)
df <- read.csv("Usona_PSIL2012.csv")
setwd("~/Google Drive/My Drive/new adventure/I.Ai Shared Drive/08. Press and Public Presentations/ACNP Submission")
df <- read.csv("Usona_PSIL2012.csv")
df_chg <- df %>% pivot_wider(names_from = AVISIT, values_from = AVALC) %>% mutate(chg = `Week 6` - Baseline) %>% as.data.frame(.)
result <- estimateHTE(df_chg[df_chg$ARM=="Placebo","chg"],df_chg[df_chg$ARM=="Psilocybin","chg"])
plot(result)
summary(result)
a <- testHTE(result)
summary(a)
a
seq(from=3,to=97,by=2)/100
length(seq(from=3,to=97,by=2)/100)
head(loebel_data)
raison_data <- df_chg
names(raison_data)
head(raison_data)
names(raison_data)[6] <- "MADRSchg"
head(raison_data)
raison_data <- raison_data[,which(names(raison_data)!="PARAM")]
head(raison_data)
names(raison_data)[2] <- "arm"
head(raison_data)
nrow(raison)
nrow(raison_data)
result <- estimateHTE(raison_data[raison_data$arm=="Placebo","MADRSchg"],raison_data[raison_data$arm=="Psilocybin","MADRSchg"])
plot(result)
summary(result)
?saveRDS
setwd("~/eHTE/data")
saveRDS(raison_data,file="raison_data.rda")
load("~/eHTE/data/raison_data.rda")
rm(list=c(raison_data))
rm(list=c("raison_data"))
load(raison_data.rda)
load("raison_data.rda")
load("~/eHTE/data/raison_data.rda")
raison_data <- df_chg
names(raison_data)[2] <- "arm"
names(raison_data)[6] <- "MADRSchg"
raison_data <- raison_data[,which(names(raison_data)!="PARAM")]
head(raison_data)
save(raison_data,file="raison_data.rda")
a <- load(file="raison_data.rda")
head(a)
a
load(file="raison_data.rda")
raison_data
rm(list=c("raison_data"))
raison_data
load(file="raison_data.rda")
raison_data
setwd("/Users/chrischatham/eHTE")
document()
build()
devtools::install_github("chchatham/eHTE",force=TRUE)
library(eHTE)
?eHTE
document()
build()
setwd("~/Google Drive/My Drive/new adventure/I.Ai Shared Drive/08. Press and Public Presentations/ACNP Submission")
devtools::install_github("chchatham/eHTE",force=TRUE)
library(eHTE)
?eHTE
setwd("~/eHTE/R")
document()
build()
devtools::install_github("chchatham/eHTE",force=TRUE)
library(eHTE)
?eHTE
document()
build()
n_per_arm <- rep(seq(from=20, to=300, by=20),1000)
SDplacebo <- 5
responder_ITE <- c(1*SDplacebo,1.5*SDplacebo,2*SDplacebo)
placebo_effect <- 2*SDplacebo
responder_proportion <- c(.2,.3,.4)
SDresponder <- c(1,3,5)
SDnonresponder <- c(1,3,5)
pctiles <- seq(from=3,to=97,by=2)/100
n_perm <- 1000
median_deviate <- FALSE
results <- expand.grid(n_per_arm=n_per_arm,SDplacebo=SDplacebo,responder_ITE=responder_ITE,
placebo_effect=placebo_effect,responder_proportion=responder_proportion,
SDresponder=SDresponder,SDnonresponder=SDnonresponder,eHTE=NA,detected=NA,
AD.test=NA,T.AD.test=NA,AD_p_val=NA,AD_detected=0)
eHTE_estimate <- function(placebo_arm,drug_arm,pctiles,placebo_sd){
quantiles_placebo <- quantile(placebo_arm,probs=pctiles)
quantiles_drug <- quantile(drug_arm,probs=pctiles)
D_xi <- quantiles_drug - quantiles_placebo
return(sd(D_xi) / placebo_sd)
}
estimateHTE <- function(placebo_arm,drug_arm,pctiles=seq(from=3,to=97,by=2)/100){
n_pbo <- length(placebo_arm)
n_act <- length(drug_arm)
quantiles_placebo <- quantile(placebo_arm,probs=pctiles)
quantiles_drug <- quantile(drug_arm,probs=pctiles)
D_xi <- quantiles_drug - quantiles_placebo
eHTE <- sd(D_xi) / sd(placebo_arm)
result <- list(eHTE = eHTE,
n_pbo = n_pbo,
n_act = n_act,
placebo_arm=placebo_arm,
drug_arm=drug_arm,
pctiles=pctiles,
D_xi=D_xi,
pval=NULL)
return(result)
}
result <- estimateHTE(raison_data[raison_data$arm=="Placebo","MADRSchg"],raison_data[raison_data$arm=="Psilocybin","MADRSchg"])
plot(result)
summary(result)
result
result$eHTE
length(seq(from=3,to=97,by=2)/100)
?sd
estimateHTE <- function(placebo_arm,drug_arm,pctiles=seq(from=3,to=95,by=2)/100){
n_pbo <- length(placebo_arm)
n_act <- length(drug_arm)
quantiles_placebo <- quantile(placebo_arm,probs=pctiles)
quantiles_drug <- quantile(drug_arm,probs=pctiles)
D_xi <- quantiles_drug - quantiles_placebo
eHTE <- sd(D_xi) / sd(placebo_arm)
result <- list(eHTE = eHTE,
n_pbo = n_pbo,
n_act = n_act,
placebo_arm=placebo_arm,
drug_arm=drug_arm,
pctiles=pctiles,
D_xi=D_xi,
pval=NULL)
return(result)
}
result <- estimateHTE(raison_data[raison_data$arm=="Placebo","MADRSchg"],raison_data[raison_data$arm=="Psilocybin","MADRSchg"])
result$eHTE
estimateHTE <- function(placebo_arm,drug_arm,pctiles=seq(from=3,to=99,by=2)/100){
n_pbo <- length(placebo_arm)
n_act <- length(drug_arm)
quantiles_placebo <- quantile(placebo_arm,probs=pctiles)
quantiles_drug <- quantile(drug_arm,probs=pctiles)
D_xi <- quantiles_drug - quantiles_placebo
eHTE <- sd(D_xi) / sd(placebo_arm)
result <- list(eHTE = eHTE,
n_pbo = n_pbo,
n_act = n_act,
placebo_arm=placebo_arm,
drug_arm=drug_arm,
pctiles=pctiles,
D_xi=D_xi,
pval=NULL)
return(result)
}
result <- estimateHTE(raison_data[raison_data$arm=="Placebo","MADRSchg"],raison_data[raison_data$arm=="Psilocybin","MADRSchg"])
result$eHTE
estimateHTE <- function(placebo_arm,drug_arm,pctiles=seq(from=3,to=97,by=2)/100){
n_pbo <- length(placebo_arm)
n_act <- length(drug_arm)
quantiles_placebo <- quantile(placebo_arm,probs=pctiles)
quantiles_drug <- quantile(drug_arm,probs=pctiles)
D_xi <- quantiles_drug - quantiles_placebo
eHTE <- sd(D_xi) / sd(placebo_arm)
result <- list(eHTE = eHTE,
n_pbo = n_pbo,
n_act = n_act,
placebo_arm=placebo_arm,
drug_arm=drug_arm,
pctiles=pctiles,
D_xi=D_xi,
pval=NULL)
return(result)
}
result <- estimateHTE(raison_data[raison_data$arm=="Placebo","MADRSchg"],raison_data[raison_data$arm=="Psilocybin","MADRSchg"])
result$eHTE
estimateHTE <- function(placebo_arm,drug_arm,pctiles=seq(from=3,to=99,by=2)/100){
n_pbo <- length(placebo_arm)
n_act <- length(drug_arm)
quantiles_placebo <- quantile(placebo_arm,probs=pctiles)
quantiles_drug <- quantile(drug_arm,probs=pctiles)
D_xi <- quantiles_drug - quantiles_placebo
eHTE <- sd(D_xi) / sd(placebo_arm)
result <- list(eHTE = eHTE,
n_pbo = n_pbo,
n_act = n_act,
placebo_arm=placebo_arm,
drug_arm=drug_arm,
pctiles=pctiles,
D_xi=D_xi,
pval=NULL)
return(result)
}
result <- estimateHTE(raison_data[raison_data$arm=="Placebo","MADRSchg"],raison_data[raison_data$arm=="Psilocybin","MADRSchg"])
result$eHTE
